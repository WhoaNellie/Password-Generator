<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Password Generator</title>
  </head>
  <body>
    <header>
      <h1>Password Generator</h1>
    </header>
    <h2>Generate a Password</h2>

        <h3>Select Criteria</h3>

        Password Length: <input type="range" id="len" min="8" max="128">

        <input type="checkbox" name="lowercase" id="lower"> Lowercase letters<br>
        <input type="checkbox" name="uppercase" id="upper"> Uppercase letters<br>
        <input type="checkbox" name="numeric" id="number"> Numbers 0-9 <br>
        <input type="checkbox" name="special" id="special"> Special characters (? ! . _ , etc.)<br>
        <input type="checkbox" name="selAll" id="all"> Select all<br>


    <textarea
      id="password"
      placeholder="Your Secure Password"
      aria-label="Generated Password"
    ></textarea>

    <button id="generate">Generate Password</button>
    <button onclick="clipText()" id="copy">
      Copy to Clipboard
    </button>

  </body>
  <script type="text/javascript">

    let lcStr = "abcdefghijklmnopqrstuvwqyz";
        let lcRegex = /[a-z]/;
    let ucStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        let ucRegex = /[A-Z]/;
    let intStr = "0123456789";
        let intRegex = /\d/;
    let specStr = " !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";
        let specRegex = /\W/;
    
    let passLen = document.getElementById("len").value;

    let checkLow = document.getElementById("lower");
    let checkUp = document.getElementById("upper");
    let checkNum = document.getElementById("number");
    let checkSpec = document.getElementById("special");
    let checkAll = document.getElementById("all");

    let selectFrom = "";
    let password = "";

       
        function passOk (pWord){
            if (
                (checkLow.checked && !lcRegex.test(pWord))||
                (checkUp.checked && !ucRegex.test(pWord)) ||
                (checkNum.checked && !intRegex.test(pWord))
                // || (checkSpec.checked && !specRegex.test(pWord))
            ){ 

                return false;

            }else if (checkAll.checked && 
                (
                    !lcRegex.test(pWord) ||
                    !ucRegex.test(pWord) ||
                    !intRegex.test(pWord)
                    // || !specRegex.test(pWord)
                )){

                    return false;

            }else{

                return true;
            }

        }

        function passGen(){
            if (
            !checkLow.checked &&
            !checkUp.checked &&
            !checkSpec.checked &&
            !checkNum.checked &&
            !checkAll.checked
            ){
                alert("Please select at least one password criteria");
            }

            selectFrom = (
                ((checkAll.checked || checkLow.checked) ? lcStr : '') + 
                ((checkAll.checked || checkUp.checked )? ucStr : '') +
                ((checkAll.checked || checkNum.checked) ? intStr : '')
                );
                // + (checkAll.checked || checkSpec.checked ? specStr : '');
                


            do{
                password = "";
                for (let i = 0; i < Number(passLen); i++){
                    let rand = Math.floor(Math.random() * selectFrom.length);
                    password = password + selectFrom.charAt(rand);
                    console.log(password);
                    // debugger;
                }
            }while(!passOk(password))
        }

        function clipText() {
            let copyText = document.getElementById("password");
            copyText.select();
            copyText.setSelectionRange(0, 99999)
            document.execCommand("copy");
        }
  </script>
</html>
